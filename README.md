1)создаем виртуальное окружение и устанавливаем зависимости
pip install -r requirements.txt

2) В файле check_domain.py
"Проверка email-доменов"
В блоке запуска в массиве заменить список email-адресов и запустить

3) Для работы telega_send.py нужно создать ".env" файл и поместить в него TOKEN и CHAT_ID в формате
TOKEN=здесь_ваш_токен
CHAT_ID=здесь_ваш_id чата
И не забываем что бот не отправит сообщение тому кто первый не напишет ему :)

4)
Архитектура email-рассылки для 1200 адресов (MVP)

Общая схема
Приложение на FastAPI + Celery/Redis отправляет письма через 2-3 провайдера (Amazon SES, Mailgun, Elastic Email).
Postgres хранит кампании и чёрный список email-адресов.
Prometheus собирает метрики.
Всё крутится на паре дешёвых VPS (Hetzner/DO).

Компоненты
Backend: FastAPI принимает задания, складывает в Redis, Celery-воркеры разбирают очередь и отправляют письма.
SMTP: Начинаем с Amazon SES (10Р/1000 писем). Если заблокируют - переключаемся на Mailgun или Elastic Email.
Для каждого клиента/направления используем отдельные поддомены (client1.yourdomain.com, client2.yourdomain.com).
Rate limiting: Воркеры контролируют скорость отправки (например, 10 писем/сек на провайдера, 100/мин на gmail.com).
Жёсткие лимиты прописаны в коде.

Suppression:
Hard bounce → сразу в чёрный список. (мертвые ящики)
Complaint → тоже в чёрный список + алерт админу. (При нажатии 'Это спам')
Soft bounce → 3 попытки с задержкой, потом в чёрный список.

Мониторинг: Prometheus + Grafana на том же VPS.
Отслеживаем bounce rate, complaint rate, latency, uptime провайдеров.
Если bounce rate >2% - автопауза кампании и уведомление в TG.

Ротация
Воркер выбирает провайдера по схеме:
смотрит текущую загрузку (сколько писем в очереди), bounce rate за последний час, uptime.
Берёт провайдера с лучшими показателями.
Если провайдер возвращает серверные ошибки три раза подряд — помечаем его degraded на 10 минут и переключаемся на следующего.
Между поддоменами чередуем round-robin внутри кампании.

Распределение нагрузки
Scheduler формирует батчи по 50-100 писем, кладёт в Redis с задержкой. Воркеры разбирают батчи параллельно.
При пике нагрузки автоувеличение воркеров.

Риски
Блокировка домена/ip: несколько провайдеров + несколько поддоменов = если один улетел, то остальные работают
Высокий bounce rate: жёсткий suppression list + MX-проверка адресов перед отправкой = отсекаем мёртвые адреса
Падение VPS: два VPS в разных ЦОДах, nginx балансирует. Postgres реплика на второй машине (async)
Перегрузка: очередь в Redis буферизует пики, воркеры растут горизонтально

Стоимость (MVP):
2× Hetzner VPS (CPX11): ~ 1000 Р/мес
Amazon SES: 1200 адресов: ~ 12 Р
2-3 домена: 300 Р/мес
Cloudflare DNS: бесплатно
Мониторинг: бесплатно

Итого: от 1300 Р.
Внедрение (+- 2 недели)